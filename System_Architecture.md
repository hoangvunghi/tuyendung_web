# Kiến Trúc Hệ Thống Tuyển Dụng

## Tổng Quan Kiến Trúc

Dưới đây là sơ đồ kiến trúc tổng thể của hệ thống:

```
+--------------------------------------------------------------------------------------------------+
|                                                                                                  |
|                                    Kiến Trúc Hệ Thống Tuyển Dụng                                 |
|                                                                                                  |
+--------------------------------------------------------------------------------------------------+

+------------------+                 +-------------------+                  +------------------+
|                  |                 |                   |                  |                  |
|  Frontend (FE)   | <----------->  |   Backend (BE)    | <------------->  |  Cloud Services  |
|  (tuyendung-fe)  |                 |    (tuyendung)    |                  |                  |
|                  |                 |                   |                  |                  |
+--------+---------+                 +---------+---------+                  +---------+--------+
         |                                     |                                      |
         |                                     |                                      |
         v                                     v                                      v
+------------------+                 +-------------------+                  +------------------+
|                  |                 |                   |                  |                  |
|  Vue.js + Vite   |                 |    Django + DRF   |                  |     AWS/S3       |
|  Pinia           | <----------->   |    Celery + Redis | <------------->  |   Cloudinary     |
|  Socket.io       |                 |    PostgreSQL     |                  |     Google       |
|                  |                 |                   |                  |                  |
+------------------+                 +------------------+                   +------------------+
         |                                     |                                      |
         |                                     |                                      |
         v                                     v                                      v
+------------------+                 +-------------------+                  +------------------+
|   Web Browser    |                 |                   |                  |   Payment        |
|   (Client Side)  | <----------->   |   REST API &      | <------------->  |   Gateway        |
|                  |                 |   WebSockets      |                  |   (VNPay)        |
+------------------+                 +-------------------+                  +------------------+
```

## Kiến Trúc Chi Tiết Frontend (tuyendung-fe)

```
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                               Frontend (tuyendung-fe)                                         |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+

+------------------+     +------------------+     +------------------+     +------------------+
|                  |     |                  |     |                  |     |                  |
|    Components    |     |     Views        |     |    Services      |     |     Stores       |
|                  |     |                  |     |                  |     |                  |
+--------+---------+     +--------+---------+     +--------+---------+     +--------+---------+
         |                       |                        |                        |
         |                       |                        |                        |
         v                       v                        v                        v
+------------------+     +------------------+     +------------------+     +------------------+
|  UI Elements     |     |  Page Templates  |     |  API Calls       |     |  State Mgmt      |
|  Reusable Parts  |     |  User Interfaces |     |  Data Fetching   |     |  Data Storage    |
|  Button, Cards   |     |  Login, Profile  |     |  Authentication  |     |  User Info       |
+------------------+     +------------------+     +------------------+     +------------------+
         |                       |                        |                        |
         |                       |                        |                        |
         v                       v                        v                        v
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                      Vue Router                                               |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
                                             |
                                             v
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                     Axios / HTTP Client                                       |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
                                             |
                                             v
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                     Backend API Endpoints                                     |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
```

## Kiến Trúc Chi Tiết Backend (tuyendung)

```
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                               Backend (tuyendung)                                             |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+

+------------------+     +------------------+     +------------------+     +------------------+
|                  |     |                  |     |                  |     |                  |
|    accounts      |     |    enterprises   |     |     profiles     |     |   transactions   |
|                  |     |                  |     |                  |     |                  |
+--------+---------+     +--------+---------+     +--------+---------+     +--------+---------+
         |                       |                        |                        |
         |                       |                        |                        |
         v                       v                        v                        v
+------------------+     +------------------+     +------------------+     +------------------+
|  User Accounts   |     |  Enterprises     |     |  User Profiles   |     |  Payments        |
|  Authentication  |     |  Job Posts       |     |  CV Management   |     |  Subscriptions   |
|  Permissions     |     |  Fields & Pos.   |     |  User Info       |     |  VNPay Integ.    |
+------------------+     +------------------+     +------------------+     +------------------+

+------------------+     +------------------+     +------------------+     +------------------+
|                  |     |                  |     |                  |     |                  |
|   notifications  |     |     chat         |     |    interviews    |     |     services     |
|                  |     |                  |     |                  |     |                  |
+--------+---------+     +--------+---------+     +--------+---------+     +--------+---------+
         |                       |                        |                        |
         |                       |                        |                        |
         v                       v                        v                        v
+------------------+     +------------------+     +------------------+     +------------------+
|  User Notifs     |     |  Messaging       |     |  Interviews      |     |  Utility Svcs    |
|  Real-time       |     |  Conversations   |     |  Scheduling      |     |  External APIs   |
|  WebSockets      |     |  WebSockets      |     |  Management      |     |  Helpers         |
+------------------+     +------------------+     +------------------+     +------------------+
         |                       |                        |                        |
         |                       |                        |                        |
         v                       v                        v                        v
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                           Django REST Framework (API Layer)                                   |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
                                             |
                                             v
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                   Django Channels (WebSockets)                                |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
                                             |
                                             v
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                   Celery (Async Tasks)                                        |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
                                             |
                                             v
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                PostgreSQL (Database)                                          |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
```

## Luồng Dữ Liệu & Tích Hợp

```
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                           Luồng Dữ Liệu & Tích Hợp                                           |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+

  +-------------------+           HTTP/REST APIs           +-------------------+
  |                   | <------------------------------->  |                   |
  |   Frontend (FE)   |                                    |   Backend (BE)    |
  |   tuyendung-fe    | <------------------------------->  |   tuyendung       |
  |                   |          WebSockets (WS)           |                   |
  +-------------------+                                    +-------------------+
          ^                                                         ^
          |                                                         |
          |                                                         |
          v                                                         v
  +-------------------+                                    +-------------------+
  |                   |                                    |                   |
  |   Local Storage   |                                    |   Redis Cache     |
  |   Browser Cache   |                                    |   Celery Queue    |
  |                   |                                    |                   |
  +-------------------+                                    +-------------------+
                                                                   ^
                                                                   |
                  +------------------------------------------+     |
                  |                                          |     |
                  v                                          v     v
  +---------------+---+     +-------------------+     +---------------+---+
  |                   |     |                   |     |                   |
  |   Google OAuth    |     |  Cloudinary CDN   |     |   VNPay Gateway   |
  |   Authentication  |     |  Media Storage    |     |   Payment System  |
  |                   |     |                   |     |                   |
  +-------------------+     +-------------------+     +-------------------+
                                                               |
                                                               v
                                                    +-------------------+
                                                    |                   |
                                                    |   Banking System  |
                                                    |                   |
                                                    +-------------------+
```

## Mô Hình Triển Khai

```
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                  Mô Hình Triển Khai                                           |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+

  +-----------------------------+           +-----------------------------+
  |                             |           |                             |
  |    Production Environment   |           |    Development Environment  |
  |                             |           |                             |
  +-----------------------------+           +-----------------------------+
  |                             |           |                             |
  | +-------------------------+ |           | +-------------------------+ |
  | |                         | |           | |                         | |
  | |  Frontend Web Server    | |           | |  Local Frontend Server  | |
  | |  Nginx + Vue.js         | |           | |  Vite Dev Server        | |
  | |                         | |           | |                         | |
  | +-------------------------+ |           | +-------------------------+ |
  |                             |           |                             |
  | +-------------------------+ |           | +-------------------------+ |
  | |                         | |           | |                         | |
  | |  Backend API Server     | |           | |  Local Backend Server   | |
  | |  Django + Gunicorn      | |           | |  Django Dev Server      | |
  | |                         | |           | |                         | |
  | +-------------------------+ |           | +-------------------------+ |
  |                             |           |                             |
  | +-------------------------+ |           | +-------------------------+ |
  | |                         | |           | |                         | |
  | |  WebSocket Server       | |           | |  Local WebSocket Server | |
  | |  Daphne + Channels      | |           | |  Django Channels        | |
  | |                         | |           | |                         | |
  | +-------------------------+ |           | +-------------------------+ |
  |                             |           |                             |
  | +-------------------------+ |           | +-------------------------+ |
  | |                         | |           | |                         | |
  | |  Async Workers          | |           | |  Local Celery Worker    | |
  | |  Celery + Redis         | |           | |  Celery + Redis         | |
  | |                         | |           | |                         | |
  | +-------------------------+ |           | +-------------------------+ |
  |                             |           |                             |
  | +-------------------------+ |           | +-------------------------+ |
  | |                         | |           | |                         | |
  | |  Database               | |           | |  Local Database         | |
  | |  PostgreSQL             | |           | |  PostgreSQL/SQLite      | |
  | |                         | |           | |                         | |
  | +-------------------------+ |           | +-------------------------+ |
  |                             |           |                             |
  +-----------------------------+           +-----------------------------+
```

## Luồng Xác Thực & Phân Quyền

```
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                              Luồng Xác Thực & Phân Quyền                                      |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+

+-------------+     +----------------+     +----------------+     +-------------------+
|             |     |                |     |                |     |                   |
|   Client    | --> | Login Request  | --> | Authentication | --> | JWT Token         |
|             |     |                |     |                |     | Generation        |
+-------------+     +----------------+     +----------------+     +-------------------+
                                                                          |
       ^                                                                  v
       |                                                   +-------------------+
       |                                                   |                   |
       |                                                   | Role Assignment   |
       |                                                   |                   |
       |                                                   +-------------------+
       |                                                            |
       |                                                            v
       |              +----------------+                 +-------------------+
       |              |                |                 |                   |
       +------------- | Protected      | <-------------- | Authorization     |
                      | Resources      |                 | Check             |
                      |                |                 |                   |
                      +----------------+                 +-------------------+

+--------------+     +----------------+     +-----------------+
|              |     |                |     |                 |
| Google       | --> | OAuth2 Flow    | --> | Social Auth     |
| Account      |     |                |     | Pipeline        |
|              |     |                |     |                 |
+--------------+     +----------------+     +-----------------+
                                                   |
                                                   v
                                           +-----------------+
                                           |                 |
                                           | User Creation   |
                                           | or Linking      |
                                           |                 |
                                           +-----------------+
                                                   |
                                                   v
                                           +-----------------+
                                           |                 |
                                           | JWT Token       |
                                           | Generation      |
                                           |                 |
                                           +-----------------+
```

## Luồng Thanh Toán

```
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                                    Luồng Thanh Toán                                           |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+

+-------------+     +----------------+     +----------------+     +-------------------+
|             |     |                |     |                |     |                   |
|   User      | --> | Select Premium | --> | Payment Page   | --> | VNPay Gateway     |
|             |     | Package        |     | Generation     |     | Redirect          |
+-------------+     +----------------+     +----------------+     +-------------------+
      ^                                                                    |
      |                                                                    v
      |                                                          +-------------------+
      |                                                          |                   |
      |                                                          | VNPay Payment     |
      |                                                          | Processing        |
      |                                                          +-------------------+
      |                                                                    |
      |                                                                    v
      |              +----------------+                           +-------------------+
      |              |                |                           |                   |
      |              | Update User    | <------------------------ | Payment Callback  |
      |              | Premium Status |                           | Handling          |
      |              |                |                           |                   |
      |              +----------------+                           +-------------------+
      |                      |
      |                      v
      |              +----------------+
      |              |                |
      |              | Generate       |
      |              | Transaction    |
      |              | Record         |
      |              +----------------+
      |                      |
      |                      v
      |              +----------------+
      |              |                |
      +------------- | Redirect to    |
                     | Success Page   |
                     |                |
                     +----------------+
```

## Cơ chế Realtime và WebSocket

```
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|                             Cơ chế Realtime và WebSocket                                      |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+

+-----------------+           +-----------------+            +-----------------+
|                 |           |                 |            |                 |
|  Client Side    |  <------> |  WebSocket      |  <------>  |  Server Side    |
|  Socket.io      |           |  Connection     |            |  Django Channels|
|                 |           |                 |            |                 |
+-----------------+           +-----------------+            +-----------------+
        |                              |                             |
        v                              v                             v
+-----------------+           +-----------------+            +-----------------+
|                 |           |                 |            |                 |
|  Event Listeners |           |  Message        |            |  Consumers      |
|  UI Updates     |           |  Protocol       |            |  Groups         |
|                 |           |                 |            |                 |
+-----------------+           +-----------------+            +-----------------+
                                      |                             |
                                      |                             |
                                      v                             v
                              +-----------------+            +-----------------+
                              |                 |            |                 |
                              |  Notification   |  <------>  |  Database       |
                              |  Chat           |            |  Updates        |
                              |                 |            |                 |
                              +-----------------+            +-----------------+
```

## Chú thích

- **Frontend (tuyendung-fe)**: Ứng dụng Vue.js được xây dựng bằng Vite, sử dụng Pinia để quản lý trạng thái và Socket.io cho giao tiếp realtime.
- **Backend (tuyendung)**: Ứng dụng Django với Django REST Framework cho API, Django Channels cho WebSockets và Celery cho xử lý bất đồng bộ.
- **Database**: PostgreSQL được sử dụng làm cơ sở dữ liệu chính.
- **Caching & Messaging**: Redis được sử dụng cho caching và hàng đợi tin nhắn.
- **Cloud Storage**: Cloudinary được sử dụng để lưu trữ và phân phối media, AWS S3 cho backup.
- **Authentication**: Hỗ trợ JWT và OAuth2 (Google) thông qua Social Auth.
- **Payment Gateway**: Tích hợp với VNPay để xử lý thanh toán trực tuyến.

---

*Ghi chú: Sơ đồ này được tạo bằng ASCII Art với ký hiệu nét đứt để biểu diễn kiến trúc hệ thống. Các kết nối và luồng dữ liệu được thể hiện bằng mũi tên và các đường kết nối.* 